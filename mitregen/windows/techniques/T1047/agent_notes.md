T1047: Execute Command Line Utility/Process with Restricted Privileges (Windows)
- Description: The technique allows an attacker to execute a command line utility or process using restricted privileges, such as those granted by user accounts that have limited privilege access. This can be achieved by running the process under a less privileged account, which prevents it from interacting with administrative resources on the system.
- Techniques:
  - User Account Control (UAC): The UAC feature in Windows limits the privileges of users and processes to prevent them from accessing certain system resources. By default, all users have limited privileges, while administrators are granted elevated permissions. When a user attempts to execute a command line utility or process with elevated privileges, they must provide administrative credentials to confirm the action.
  - Windows Registry: The Windows Registry is a database used by the operating system to store configuration settings and options. Attackers can exploit this database by creating new keys or modifying existing ones in order to execute restricted processes. This can be done either by using a malicious payload that modifies the registry, or by creating a new user account with elevated privileges and modifying the permissions on specific system files.
  - Microsoft Management Console (MMC): The MMC provides a graphical interface for managing Windows services and resources. Attackers can exploit this feature to execute restricted processes by creating a new user account with elevated privileges, then launching an MMC console from that account. They can then modify the permissions on specific system files or create new keys in the registry database to run restricted processes.
  - PowerShell: The Windows command-line shell provides a powerful scripting language called PowerShell, which allows users to automate various administrative tasks. Attackers can exploit this feature by creating a PowerShell script that executes a restricted process using elevated privileges. This can be achieved either through an exploit that creates a new user account with elevated permissions or by leveraging existing vulnerabilities in the Windows operating system.
- Mitigation: The mitigation strategies for T1047 include preventing unauthorized access to administrative resources, monitoring and auditing user activity, implementing access controls and privilege policies, and regularly updating Windows software and patches. Additionally, using security tools such as antivirus and firewalls can help to detect and prevent malicious activities on the system.
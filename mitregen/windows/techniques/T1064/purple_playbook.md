[Purple Team Playbook: T1064 - PowerShell Empire]

Objective: Test detection and response capabilities for this technique on Windows.

Red Team Activities:

Setup:
- Prerequisites and environment setup: Check if the system is running in a virtual machine or physical device, check if the Windows version is supported by PowerShell Empire (Windows 10/11), install and update necessary software and tools like PowerShell Empire.

Execution Steps:
- Execute the technique: Launch the PowerShell Empire tool and run the "Invoke-PowerShell" command to execute a script containing the T1064 technique.
- Expected Artifacts: Log entries, file modifications, network traffic generated by PowerShell Empire.

Blue Team Activities:

Pre-Exercise:
- Detection rules and monitoring setup: Create detection rules for known PowerShell Empire scripts and enable them on the endpoint security solution.

During Exercise:
- Real-time monitoring and alert verification: Monitor endpoints in real-time using an endpoint protection tool with a scripting engine, such as Microsoft Defender ATP.

Post-Exercise:
- Analysis and improvement recommendations: Analyze the logs and network traffic generated by PowerShell Empire to identify any potential threats or vulnerabilities, make recommended improvements for detection rules and monitoring techniques.

Success Criteria: Detect and respond effectively to T1064 using PowerShell Empire on Windows 10/11.